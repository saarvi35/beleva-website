{% extends 'base.html' %}

{% load static %}

{% block content %}
{% if messages %}
  <div id="floating-message" class="position-fixed top-25 start-50 translate-middle-x mt-3 px-4 py-2 rounded shadow text-center small" 
       style="z-index: 1055; background-color: white; min-width: 300px;">
    {% for message in messages %}
      <span class="{% if message.tags == 'success' %}text-success
                   {% elif message.tags == 'error' or message.tags == 'danger' %}text-danger
                   {% elif message.tags == 'warning' %}text-warning
                   {% else %}text-secondary{% endif %}">
        {{ message }}
      </span>
    {% endfor %}
  </div>
{% endif %}
<!-- Carousel -->
<div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">

  <!-- Carousel Indicators -->
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active" aria-current="true"
      aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>

  <!-- Carousel Items -->
  <div class="carousel-inner">
    <div class="carousel-item position-relative active" style="height: 650px; overflow: hidden;">
      <img src="{% static 'images/background.jpeg' %}" class="d-block w-100 rounded-0" alt="Slide 1">
    </div>
    
    <div class="carousel-item position-relative" style="height: 650px; overflow: hidden;">
      <img src="{% static 'images/back.jpeg' %}" class="d-block w-100 rounded-0" alt="Slide 2">
    </div>

    <div class="carousel-item position-relative" style="height: 650px; overflow: hidden;">
      <img src="{% static 'images/back2.png' %}" class="d-block w-100 rounded-0" alt="Slide 3" style="object-fit: cover;">
    </div>
  </div>

  <!-- Carousel Controls -->
  <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>

  <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>

</div>

<!-- categories -->
<section class="py-5 bg-white">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="text-center fw-semibold display-5 mb-4" style="font-family: 'Playfair Display', serif;">
        HOT CATEGORIES
      </h2>
      <a href="{% url 'categories' %}" class="btn-view-all">VIEW ALL CATEGORIES</a>
    </div>
    <div class="row justify-content-center">
      {% for category in categories %}
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
        <a href="{% url 'categories' %}" class="text-decoration-none text-dark">

          <div class="card product-card border-1 shadow-lg p-3" style="border-radius: 16px;">
            <img src="{{ category.category_image.url }}" class="product-img mb-3"
              style="height: 250px; object-fit: cover; border-radius: 10px;" alt="{{ category.category_name }}">
            <h5 class="fw-semibold mb-1 text-dark text-truncate">{{ category.category_name }}</h5>
            <p class="text-muted small mb-2 text-truncate">{{ category.description }}</p>
          </div>

        </a>
      </div>

      {% endfor %}
    </div>
  </div>
</section>

<!-- deals of the day -->
<div class="container py-5 shadow rounded-4" style="background: linear-gradient(135deg, #fef6f9, #e8f0ff);">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="fw-semibold display-5 mb-4 text-capitalize" style="font-family: 'Playfair Display', serif;">Deals of the Day</h3>
    <a href="{% url 'all_products' %}?deals=true" class="btn-view-all">VIEW ALL PRODUCTS</a>
  </div>
  <hr>

  <div class="row">
    <!-- Banner Left -->
    <div class="col-lg-4">
      <img src="{% static 'images/salebanner.jpg' %}" class="img-fluid rounded shadow" alt="Deals Banner" style="max-height:370px ; width: 100%;">
    </div>

    <!-- Scrollable Products Right -->
    <div class="col-lg-8 position-relative overflow-auto hide-scrollbar">
      <!-- Scrollable wrapper -->
      <div class="position-relative">
        <button id="scrollLeftBtn"
          class="btn position-absolute top-50 start-0 translate-middle-y bg-white rounded-circle shadow d-none d-md-flex justify-content-center align-items-center"
          style="z-index: 10; width: 36px; height: 36px;">
          <i class="bi bi-chevron-left fs-5 m-0 p-0"></i>
        </button>

        <!-- Products Scrollable -->
        <div id="productScroll" class="d-flex overflow-auto px-5 hide-scrollbar" style="scroll-behavior: smooth;">
          {% for product in deals %}
          <div class="card product-card p-3 m-2 flex-shrink-0"
               style="width: 300px; scroll-snap-align: start;">
            <!-- Image -->
            {% with product.details_image.all|first as first_image %}
              {% if first_image %}
                <img src="{{ first_image.image.url }}" class="card-img-top" style="height: 180px; object-fit: contain; background-color: white;" alt="{{ product.product_name }}">
              {% else %}
                <img src="{% static 'images/no-image.png' %}" class="card-img-top p-3" style="height: 180px; object-fit: contain;" alt="No Image">
              {% endif %}
            {% endwith %}

            <!-- Hover Icons -->
            <div class="position-absolute top-0 end-0 m-2 d-flex flex-column gap-2 opacity-0 hover-icons transition">
              <button class="btn btn-sm btn-light rounded-circle shadow-sm"><i class="fas fa-heart"></i></button>
              <button class="btn btn-sm btn-light rounded-circle shadow-sm"><i class="fas fa-sync-alt"></i></button>
            </div>

            <!-- Body -->
            <div class="card-body" style="height: 150px;">
                
                <a href="#" class="text-decoration-none fw-semibold text-dark d-block mb-2 text-truncate">
                  {{ product.product_name}}
                </a>
                          <!-- ratings and reviews -->
           <div class="mb-2">
            {% with rating=product.ratings %}
              {% if rating %}
                {% for i in "12345" %}
                  {% if rating >= forloop.counter %}
                    <i class="fas fa-star text-warning"></i>
                  {% elif rating >= forloop.counter0|add:"0.5" %}
                    <i class="fas fa-star-half-alt text-warning"></i>
                  {% else %}
                    <i class="far fa-star text-warning"></i>
                  {% endif %}
                {% endfor %}
                <span class="text-muted small ms-1">({{ product.reviews }} reviews)</span>
              {% else %}
                <span class="text-muted small">No reviews yet</span>
              {% endif %}
            {% endwith %}
          </div>
          <div class="mb-2 d-flex align-items-center justify-content-between flex-wrap">
            {% if product.discount_price %}
              <div >
                <span class="text-muted text-decoration-line-through">‚Çπ {{ product.original_price }}</span>
                <span class="text-danger fw-bold">‚Çπ {{ product.discount_price }}</span>
              </div>
              {% else %}
              <span class="text-danger fw-bold">‚Çπ {{ product.original_price }}</span>
              {% endif %}
            <div class="mb-2 d-flex align-items-center justify-content-between flex-wrap">
                  
                  <button class="btn position-absolute end-0 m-2 wishlist-btn "
                          data-product-id="{{ product.id }}"
                          onclick="toggleWishlist(this)"
                          title="Toggle wishlist">
                  <i class="{% if product.id in wishlist_ids %}fas{% else %}far{% endif %} fa-heart text-danger"></i>
                </button>
                </div>
          </div>
              
              <div>
                

                {% widthratio product.stock 200 100 as percent_width %}
                <div class="progress mb-1" style="height: 6px;">
                  <div class="progress-bar bg-danger" style="width: {{ percent_width }}%;"></div>
                </div>
                <p class="text-muted small mb-0">Available: {{ product.stock }}</p>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        <button id="scrollRightBtn"
          class="btn position-absolute top-50 end-0 translate-middle-y bg-white rounded-circle shadow d-none d-md-flex justify-content-center align-items-center"
          style="z-index: 10; width: 36px; height: 36px;">
          <i class="bi bi-chevron-right fs-5 m-0 p-0"></i>
        </button>

      </div>
    </div>
  </div>
</div>

<!-- featured products -->
<section class="py-5 contain">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="text-center fw-semibold display-5 mb-4 text-uppercase" style="font-family: 'Playfair Display', serif;">
        You'll love these <span>üòç</span>
      </h2>
      <a href="{% url 'all_products' %}" class="btn-view-all">VIEW ALL PRODUCTS</a>
    </div>

    <div class="row justify-content-center">
      {% for product in featured %}
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
        <!-- Card as a clickable link -->
        
          <div class="card product-card border-1 shadow-lg p-3" style="border-radius: 16px;">
<a href="{% url 'product_details' product.id %}" class="text-decoration-none text-dark">
            <img src="{{ product.details_image.first.image.url }}" ... class="product-img mb-3"
              style="height: 250px; object-fit: cover; border-radius: 10px;" alt="{{ product.product_name }}">
            <h5 class="fw-semibold mb-1 text-dark text-truncate">{{ product.product_name }}</h5>
            <p class="text-muted small text-truncate">{{ product.description }}</p>
</a>
          <!-- ratings and reviews -->
           <div class="mb-2">
            {% with rating=product.ratings %}
              {% if rating %}
                {% for i in "12345" %}
                  {% if rating >= forloop.counter %}
                    <i class="fas fa-star text-warning"></i>
                  {% elif rating >= forloop.counter0|add:"0.5" %}
                    <i class="fas fa-star-half-alt text-warning"></i>
                  {% else %}
                    <i class="far fa-star text-warning"></i>
                  {% endif %}
                {% endfor %}
                <span class="text-muted small ms-1">({{ product.reviews }} reviews)</span>
              {% else %}
                <span class="text-muted small">No reviews yet</span>
              {% endif %}
            {% endwith %}
          </div>
            <!-- Price + Wishlist icon in same row -->
            <div class="d-flex justify-content-between align-items-center px-2 mt-2">
              {% if product.discount_price %}
              <div>
                <span class="text-muted text-decoration-line-through">‚Çπ {{ product.original_price }}</span>
                <span class="text-danger fw-bold">‚Çπ {{ product.discount_price }}</span>
              </div>
              {% else %}
              <span class="text-danger fw-bold">‚Çπ {{ product.original_price }}</span>
              {% endif %}
              
                <button class="btn position-absolute end-0 m-2 wishlist-btn "
                          data-product-id="{{ product.id }}"
                          onclick="toggleWishlist(this)"
                          title="Toggle wishlist">
                  <i class="{% if product.id in wishlist_ids %}fas{% else %}far{% endif %} fa-heart text-danger"></i>
                </button>
              
            </div>
          </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- new arrivals -->
<div class="container py-5 shadow rounded-4" style="background: linear-gradient(135deg, #fef6f9, #e8f0ff);">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="fw-semibold display-5 mb-4 text-capitalize" style="font-family: 'Playfair Display', serif;">New Arrivals</h3>
    <a href="{% url 'all_products' %}?new=true" class="btn-view-all">VIEW ALL PRODUCTS</a>
  </div>
  <hr>

  <div class="row">
    <!-- Banner Left -->
    <div class="col-lg-4">
      <img src="{% static 'images/newarrival.jpg' %}" class="img-fluid rounded shadow" alt="Deals Banner" style="max-height:370px ; width: 100%;">
    </div>

    <!-- Scrollable Products Right -->
    <div class="col-lg-8 position-relative overflow-auto hide-scrollbar">
      <!-- Scrollable wrapper -->
      <div class="position-relative">
        <button id="scrollLeftBtn"
          class="btn position-absolute top-50 start-0 translate-middle-y bg-white rounded-circle shadow d-none d-md-flex justify-content-center align-items-center"
          style="z-index: 10; width: 36px; height: 36px;">
          <i class="bi bi-chevron-left fs-5 m-0 p-0"></i>
        </button>

        <!-- Products Scrollable -->
        <div id="productScroll" class="d-flex overflow-auto px-5 hide-scrollbar" style="scroll-behavior: smooth;">
          {% for product in new_arrivals %}
          <div class="card product-card p-3 m-2 flex-shrink-0"
               style="width: 300px; scroll-snap-align: start;">
            <!-- Image -->
            {% with product.details_image.all|first as first_image %}
              {% if first_image %}
                <img src="{{ first_image.image.url }}" class="card-img-top" style="height: 180px; object-fit: contain; background-color: white;" alt="{{ product.product_name }}">
              {% else %}
                <img src="{% static 'images/no-image.png' %}" class="card-img-top p-3" style="height: 180px; object-fit: contain;" alt="No Image">
              {% endif %}
            {% endwith %}

            <!-- Hover Icons -->
            <div class="position-absolute top-0 end-0 m-2 d-flex flex-column gap-2 opacity-0 hover-icons transition">
              <button class="btn btn-sm btn-light rounded-circle shadow-sm"><i class="fas fa-heart"></i></button>
              <button class="btn btn-sm btn-light rounded-circle shadow-sm"><i class="fas fa-sync-alt"></i></button>
            </div>

            <!-- Body -->
            <div class="card-body" style="height: 150px;">
                
                <a href="#" class="text-decoration-none fw-semibold text-dark d-block mb-2 text-truncate">
                  {{ product.product_name}}
                </a>
                          <!-- ratings and reviews -->
           <div class="mb-2">
            {% with rating=product.ratings %}
              {% if rating %}
                {% for i in "12345" %}
                  {% if rating >= forloop.counter %}
                    <i class="fas fa-star text-warning"></i>
                  {% elif rating >= forloop.counter0|add:"0.5" %}
                    <i class="fas fa-star-half-alt text-warning"></i>
                  {% else %}
                    <i class="far fa-star text-warning"></i>
                  {% endif %}
                {% endfor %}
                <span class="text-muted small ms-1">({{ product.reviews }} reviews)</span>
              {% else %}
                <span class="text-muted small">No reviews yet</span>
              {% endif %}
            {% endwith %}
          </div>
          <div class="mb-2 d-flex align-items-center justify-content-between flex-wrap">
            {% if product.discount_price %}
              <div >
                <span class="text-muted text-decoration-line-through">‚Çπ {{ product.original_price }}</span>
                <span class="text-danger fw-bold">‚Çπ {{ product.discount_price }}</span>
              </div>
              {% else %}
              <span class="text-danger fw-bold">‚Çπ {{ product.original_price }}</span>
              {% endif %}
            <div class="mb-2 d-flex align-items-center justify-content-between flex-wrap">
                  
                  <button class="btn position-absolute end-0 m-2 wishlist-btn "
                          data-product-id="{{ product.id }}"
                          onclick="toggleWishlist(this)"
                          title="Toggle wishlist">
                  <i class="{% if product.id in wishlist_ids %}fas{% else %}far{% endif %} fa-heart text-danger"></i>
                </button>
                </div>
          </div>
              
              <div>
                

                {% widthratio product.stock 200 100 as percent_width %}
                <div class="progress mb-1" style="height: 6px;">
                  <div class="progress-bar bg-danger" style="width: {{ percent_width }}%;"></div>
                </div>
                <p class="text-muted small mb-0">Available: {{ product.stock }}</p>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        <button id="scrollRightBtn"
          class="btn position-absolute top-50 end-0 translate-middle-y bg-white rounded-circle shadow d-none d-md-flex justify-content-center align-items-center"
          style="z-index: 10; width: 36px; height: 36px;">
          <i class="bi bi-chevron-right fs-5 m-0 p-0"></i>
        </button>

      </div>
    </div>
  </div>
</div>

<!-- customer reviews -->
<div class="review-section py-5 text-center bg-light">
  <h5 class="mb-4 fw-bold text-uppercase">We love good compliment</h5>

  <div id="reviewCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
    <div class="carousel-inner mb-4">
      <div class="carousel-item active">
        <blockquote class="blockquote m-4">
          <p>‚ÄúAbsolutely loved the fabric, <br> it‚Äôs soft and fits perfectly!‚Äù</p>
          <footer class="blockquote-footer">URBAN STYLE</footer>
        </blockquote>
      </div>
      <div class="carousel-item">
        <blockquote class="blockquote m-4">
          <p>‚ÄúStylish, comfy, and worth <br> every penny. Great buy!‚Äù</p>
          <footer class="blockquote-footer">STREET COTTON</footer>
        </blockquote>
      </div>
      <div class="carousel-item">
        <blockquote class="blockquote m-4">
          <p>‚ÄúDidn‚Äôt expect it to be this good. <br> Excellent quality and look!‚Äù</p>
          <footer class="blockquote-footer">BOLD BASICS</footer>
        </blockquote>
      </div>
    </div>
  </div>

  <!-- Custom indicators container below the carousel -->
  <div class="custom-indicators mt-3">
    <button type="button" data-bs-target="#reviewCarousel" data-bs-slide-to="0" class="active" aria-current="true"></button>
    <button type="button" data-bs-target="#reviewCarousel" data-bs-slide-to="1"></button>
    <button type="button" data-bs-target="#reviewCarousel" data-bs-slide-to="2"></button>
  </div>
</div>






<script src="{% static 'javascript/javascript.js' %}"></script>

{% endblock %}